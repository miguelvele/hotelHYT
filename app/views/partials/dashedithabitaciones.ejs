<div class="content-wrapper">

    <section class="content-header">
        <h1>
            Modificar habitaciones

        </h1>
        <ol class="breadcrumb">
            <li><a href="#"><i class="fa fa-dashboard"></i> Home</a></li>
            <li><a href="#">Examples</a></li>
            <li class="active">Blank page</li>
        </ol>
    </section>
        <section class="content">
          <div class="box">
            <div class="box-header with-border">
              <div class="box-tools pull-right">
                <button type="button" class="btn btn-box-tool" data-widget="collapse" data-toggle="tooltip" title="Collapse">
                  <i class="fa fa-minus"></i></button>
                <button type="button" class="btn btn-box-tool" data-widget="remove" data-toggle="tooltip" title="Remove">
                  <i class="fa fa-times"></i></button>
              </div>
            </div>
            <div class="box-body">
              <form action="guardarhh" id="formulario" method="post">
                <div class="form-group">
                  <label>Número de habitación</label>
                  <input type="text" class="form-control" value="<%= datos.id %>" name="id">
                </div>
                <div class="form-group">
                  <label>Código de piso</label>
                  <select class="form-control" name="codigo_piso">
                      <% pisos.forEach((piso) => { %>
                          <% if(piso.ESTADO !== 2) { %>
                              <option value="<%= piso.CODIGO_PISO %>" <% if (datos.codigo_piso == piso.CODIGO_PISO) { %> selected <% } %>><%= piso.DESCRIPCION %></option>
                          <% } %>
                      <% }); %>
                  </select>
              </div>
              
              <div class="form-group">
                  <label>Código de categoría</label>
                  <select class="form-control" name="codigo_categoria">
                      <% categorias.forEach((categoria) => { %>
                          <% if(categoria.ESTADO !== 2) { %>
                              <option value="<%= categoria.CODIGO_CATEGORIA %>" <% if (datos.codigo_categoria == categoria.CODIGO_CATEGORIA) { %> selected <% } %>><%= categoria.NOMBRE %></option>
                          <% } %>
                      <% }); %>
                  </select>
              </div>
              
              <div class="form-group">
                  <label>Código de hotel</label>
                  <select class="form-control" name="codigo_hotel">
                      <% hoteles.forEach((hotel) => { %>
                          <% if(hotel.ESTADO !== 2) { %>
                              <option value="<%= hotel.CODIGO_HOTEL %>" <% if (datos.codigo_hotel == hotel.CODIGO_HOTEL) { %> selected <% } %>><%= hotel.NOMBRE %></option>
                          <% } %>
                      <% }); %>
                  </select>
              </div>
              
              <div class="form-group">
                  <label>Estado de habitación</label>
                  <select class="form-control" name="codigo_estado_habitacion">
                      <% estadosHabitacion.forEach((estado) => { %>
                          <% if(estado.ESTADO !== 2) { %>
                              <option value="<%= estado.CODIGO_ESTADO_HABITACION %>" <% if (datos.codigo_estado_habitacion == estado.CODIGO_ESTADO_HABITACION) { %> selected <% } %>><%= estado.DESCRIPCION %></option>
                          <% } %>
                      <% }); %>
                  </select>
              </div>
                <div class="form-group">
                  <label>Detalle</label>
                  <input type="text" class="form-control" value="<%= datos.detalle %>" name="detalle">
                </div>
                <div class="form-group">
                  <label>Precio</label>
                  <input type="text" class="form-control" value="<%= datos.precio %>" name="precio">
                </div>
                <div class="form-group">
                  <label>Estado</label>
                  <select class="form-control" name="estado">
                      <option value="1" <% if (datos.estado == 1) { %> selected <% } %>>Activo</option>
                      <option value="2" <% if (datos.estado == 2) { %> selected <% } %>>Inactivo</option>
                  </select>
              </div>
              <div class="form-group">
                <label>Fecha de modificacion</label>

                <input id="fechaCreacion" name="fecha_creacion" type="text" class="form-control" readonly>

            </div>
                <div class="box-footer">
                  <button class="btn btn-app" type="submit" onclick="confirmar()">
                    <i class="fa fa-save"></i> Guardar
                  </button>
                  <a href="habitaciones" class="btn btn-danger">
                    <i class="fa fa-times"></i>
                    Cancelar
                  </a>
                </div>
              </form>
            </div>
          </div>
        </section>
      </div>

      
<script>
  let fecha = new Date().toLocaleDateString('en-CA', { timeZone: 'America/Bogota' });
  document.getElementById('fechaCreacion').value = fecha;
</script>
      
      <script>
        function confirmar() {
          const formu = document.querySelector("#formulario");
          formu.addEventListener("submit", (event) => {
            event.preventDefault();
            Swal.fire({
              title: '¿Guardar cambios?',
              text: "¡Modificarás esta habitación!",
              icon: 'question',
              showCancelButton: true,
              confirmButtonColor: '#3085d6',
              cancelButtonColor: '#d33',
              confirmButtonText: '¡Sí!'
            }).then((result) => {
              if (result.isConfirmed) {
                formu.submit();
                Swal.fire(
                  '¡Modificado!',
                  'La habitación ha sido modificada.',
                  'success'
                )
              }
            })
          })
        }
      </script>

    